# Start windows and panes at 1, not 0
set -g base-index 1
setw -g pane-base-index 1

# Renumber windows sequentially after closing any of them
set -g renumber-windows on

# Session management improvements
# Use Ctrl-b + s to see session list with better formatting
bind-key s choose-tree -s -O name

# Show only windows from the current session
unbind-key w
bind-key w choose-window
# Keep a global tree view on Shift+W
bind-key W choose-tree -s -O name

# Keep Ctrl-b + 1..9 for default window switching.
# Session switching is available on Ctrl-b + F1..F9.
bind-key F1 switch-client -t 0
bind-key F2 switch-client -t 1
bind-key F3 switch-client -t 2
bind-key F4 switch-client -t 3
bind-key F5 switch-client -t 4
bind-key F6 switch-client -t 5
bind-key F7 switch-client -t 6
bind-key F8 switch-client -t 7
bind-key F9 switch-client -t 8

# AZERTY-friendly prefix bindings (same targets as 1..4)
bind-key '&' select-window -t 1
bind-key 'Ã©' select-window -t 2
bind-key '"' select-window -t 3
bind-key "'" select-window -t 4

# Quick window switching without prefix
bind -n M-1 select-window -t 1
bind -n M-2 select-window -t 2
bind -n M-3 select-window -t 3
bind -n M-4 select-window -t 4
bind -n M-h previous-window
bind -n M-l next-window


# Quick session creation with meaningful names + 4-window workspace
bind-key C-n command-prompt -p "New session name:" "new-session -d -s %1 -c #{pane_current_path} \; send-keys -t %1:1 'nvim .' C-m \; new-window -t %1:2 -c #{pane_current_path} \; send-keys -t %1:2 opencode C-m \; new-window -t %1:3 -c #{pane_current_path} \; new-window -t %1:4 -c #{pane_current_path} \; switch-client -t %1 \; select-window -t %1:1"

# Automatically switch to next available session when closing the current session
set-hook -g session-closed 'run-shell "tmux switch-client -n"'

# Disable auto layout hook (hook context is unreliable for target expansion)
set-hook -gu session-created
set-hook -gu after-new-session

#set -g mouse on

# List of plugins
set -g @plugin 'tmux-plugins/tpm'
set -g @plugin 'tmux-plugins/tmux-sensible'
set -g @plugin 'sainnhe/tmux-fzf'

# Other examples:
# set -g @plugin 'github_username/plugin_name'
# set -g @plugin 'github_username/plugin_name#branch'
# set -g @plugin 'git@github.com:user/plugin'
# set -g @plugin 'git@bitbucket.com:user/plugin'

# Keep plugin launcher on Shift+F, and use prefix+f for direct session switching
set-environment -g TMUX_FZF_LAUNCH_KEY "F"
bind-key f run-shell -b "~/.tmux/plugins/tmux-fzf/scripts/session.sh switch"

# Initialize TMUX plugin manager (keep this line at the very bottom of tmux.conf)
run '~/.tmux/plugins/tpm/tpm'
